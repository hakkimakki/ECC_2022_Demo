<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

    <!-- Bluetooth Web -->
    <script>
    var connected_device
    var connected = false;
    var connected_led_service_characteristic;


    startScan = function () {
        navigator.bluetooth.requestDevice({ filters: [{name: 'Demo ECC Light BT-Mesh'}],optionalServices: ['00001523-1212-efde-1523-785feabcd123'] })
        .then(device => device.gatt.connect())
        .then(server => server.getPrimaryService('00001523-1212-efde-1523-785feabcd123'))
        .then(service => service.getCharacteristic('00001525-1212-efde-1523-785feabcd123'))
        .then(characteristic => {
            connected_led_service_characteristic = characteristic
            connected = true
            console.log('Connected :)')
        })
        .catch(error => { console.error(error); });
    }

    setOn = function () {
        if (connected) {
            const writeval = Uint8Array.of(1);
            connected_led_service_characteristic.writeValue(writeval).catch( error => {
                console.error(error);
            })
        } else {
            startScan()
        }
    }

    setOff = function () {
        if (connected) {
            const writeval = Uint8Array.of(0);
            connected_led_service_characteristic.writeValue(writeval).catch( error => {
                console.error(error);
            })
        } else {
            startScan()
        }
    }
    </script>    


    <title>ECC Demo Bluetooth Web</title>
    
    
</head>
<body>

    
    <p>ECC Demo Bluetooth Web</p>

    <button id="btn_on" onclick="setOn()">ON</button>
    <button id="btn_off" onclick="setOff()">OFF</button>


</body>
</html>

